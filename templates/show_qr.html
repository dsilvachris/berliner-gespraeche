{% extends "base.html" %}

{% block content %}
<div class="progress">
    <div class="progress-bar" style="width: 65%;"></div>
</div>

<div class="card">
    <h1 style="text-align: center;">Initiative Information</h1>
    <p style="color: #666; margin-bottom: 30px; text-align: center;">Bezirk: <strong>{{ district }}</strong></p>
    
    <!-- QR Code Section -->
    <div style="text-align: center; margin: 30px 0;">
        <h3>📱 QR-Code scannen für Kontaktdaten</h3>
        <div id="qr-code-container" style="margin: 20px 0;">
            <canvas id="qr-canvas" style="border: 2px solid #ddd; border-radius: 10px;"></canvas>
        </div>
        <p style="color: #666; font-size: 14px;">Scanne den QR-Code mit deinem Smartphone</p>
    </div>
    
    <div style="background: #f5f5f5; padding: 20px; border-radius: 10px; margin: 20px 0;">
        <h3>📋 Ausgewählte Initiativen:</h3>
        
        {% for initiative in initiative_details %}
        <div style="background: white; margin: 15px 0; padding: 20px; border-radius: 8px; border-left: 4px solid #4CAF50;">
            <h4 style="margin: 0 0 15px 0; color: #2E7D32; font-size: 18px;">{{ initiative.name }}</h4>
            
            <div style="margin: 10px 0;">
                <strong>📞 Kontakt:</strong>
                <p style="margin: 5px 0; color: #333;">{{ initiative.contact }}</p>
            </div>
            
            <div style="margin: 15px 0;">
                <strong>📝 Beschreibung:</strong>
                <p style="margin: 5px 0; color: #555; line-height: 1.5;">{{ initiative.summary }}</p>
            </div>
        </div>
        {% endfor %}
        
        <div style="background: #e3f2fd; margin: 25px 0; padding: 20px; border-radius: 8px; border-left: 4px solid #1976D2;">
            <h4 style="margin: 0 0 15px 0; color: #1565C0; font-size: 18px;">🌍 Klimaneustart Berlin</h4>
            
            <div style="margin: 10px 0;">
                <strong>📞 Kontakt:</strong>
                <p style="margin: 5px 0; color: #333;">
                    📧 info@klimaneustart.de<br>
                    📱 +49 30 12345678<br>
                    🌐 www.klimaneustart.de
                </p>
            </div>
            
            <div style="margin: 15px 0;">
                <strong>📝 Über uns:</strong>
                <p style="margin: 5px 0; color: #555; line-height: 1.5;">
                    Zentrale Anlaufstelle für Klimaschutz-Initiativen in Berlin. 
                    Vernetzt lokale Projekte und fördert nachhaltigen Wandel in der Stadt.
                </p>
            </div>
        </div>
    </div>
    
    <div style="text-align: center; margin-top: 40px;">
        <a href="{{ url_for('step3') }}" class="btn btn-secondary" style="margin-right: 15px;">← Zurück zu Schritt 3</a>
        <a href="{{ url_for('step4') }}" class="btn">Weiter zu Kontakt & Einverständnis →</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
<script>
// Generate QR Code
const qrData = `Sag doch mal, Berlin - Initiativen in {{ district }}\n`;
const qrText = qrData + 
    `Interessensbereiche: {{ initiative_details|map(attribute='name')|join(', ') }}\n\n` +
    `Kontakt Klimaneustart:\n` +
    `📧 info@klimaneustart.de\n` +
    `📱 +49 30 12345678\n` +
    `🌐 www.klimaneustart.de`;

const canvas = document.getElementById('qr-canvas');
QRCode.toCanvas(canvas, qrText, {
    width: 200,
    margin: 2,
    color: {
        dark: '#000000',
        light: '#FFFFFF'
    }
}, function (error) {
    if (error) console.error(error);
    console.log('QR code generated successfully!');
});
</script>
{% endblock %}